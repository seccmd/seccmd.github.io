# Git操作指南

为个人开发者量身定制的极简Git操作指南，聚焦**存档代码、开启分支、回滚、发布版本**四大核心需求，仅需掌握10个命令即可覆盖90%个人开发场景：

---

### ⚡ **一、极简操作清单（10个命令解决所有需求）**

|**场景**|**命令**|**说明**|
|-|-|-|
|**1. 存档当前代码**|`git add .` → `git commit -m "描述"`|添加所有修改并提交到本地仓库（描述写清楚功能点，如`feat: 添加支付模块`）|
|**2. 开启新分支**|`git checkout -b feature/功能名`|创建并切换到新分支（如`feature/user-profile`）|
|**3. 回滚到历史版本**|`git reset --hard 提交ID`|**彻底丢弃**最新提交（提交ID用`git log --oneline`查看前7位）|
||`git revert 提交ID`|**安全回滚**：生成新提交抵消错误（保留历史记录）|
|**4. 发布正式版本**|`git tag -a v1.0.0 -m "正式版发布"`|为当前提交打标签（版本号遵循`主版本.次版本.修订号`）|
||`git push origin --tags`|推送标签到远程仓库（如GitHub）|
|**5. 分支合并与清理**|`git checkout main` → `git merge feature/功能名`|切换回主分支并合并新功能|
||`git branch -d feature/功能名`|删除已合并的分支（保持仓库简洁）|


> 💡 **个人使用技巧**：
- **分支命名**：直接用`功能名`（如`refactor-header`），无需加`feature/`前缀（团队协作时才需规范）
- **提交频率**：每完成一个小功能就提交一次，避免积累大量改动
- **备份**：每日结束时执行`git push`，防止本地丢失  

---

### ⚠️ **二、避坑指南（个人开发者常见问题）**

1. **误删未提交的代码**  
    - 场景：写了代码但未`git add`就误删文件  
    - 恢复：用文件恢复软件（如Recuva），**Git无法恢复未跟踪的文件**  
2. **回滚后后悔了**  
    - 场景：`git reset --hard` 后发现删错了提交  
    - 恢复：用 `git reflog` 找到操作前的提交ID，再 `git reset --hard 旧ID`  
3. **发布版本后需修复Bug**  
    - 操作：基于标签创建热修复分支 → 修复后打新标签  

```Bash
git checkout v1.0.0              # 切换到发布标签
git checkout -b hotfix/login      # 创建修复分支
git commit -m "fix: 修复登录超时"  # 提交修复
git tag -a v1.0.1 -m "紧急修复登录问题"  # 打新标签
git push origin --tags            # 推送新版本
```

---

### 🌰 **三、实战场景示例（从开发到发布）**

```Bash
# 1. 开发新功能：用户头像上传
git checkout -b user-avatar     # 创建分支
git add avatar-upload.js        # 开发代码...
git commit -m "feat: 用户头像上传功能"
git push origin user-avatar     # 备份到远程

# 2. 发现旧版本BUG需回滚
git checkout main               # 切回主分支
git log --oneline               # 查看历史（假设要回滚到a1b2c3d）
git reset --hard a1b2c3d        # 回滚到稳定版本

# 3. 发布新版本
git tag -a v2.0.0 -m "支持头像上传"  # 打标签
git push origin --tags          # 发布到远程
```

---

### 🧰 **四、辅助工具推荐（个人开发效率翻倍）**

1. **VSCode Git图形化**：侧边栏一键提交/推送/切换分支（Ctrl+Shift+G）  
2. **GitHub Desktop**：拖拽管理分支，可视化回滚操作（适合新手）  
3. **GitLens插件**：在代码行内显示最后修改者，快速定位问题  

> **最终建议**：
1. 主分支（`main`）仅用于发布稳定版本，新功能全在新分支开发
2. 每次发布后打标签，版本号严格递增（`v1.0.0` → `v1.0.1`）
3. 重要操作前备份：`git push` 或复制整个项目文件夹  

掌握以上核心操作，个人项目开发效率提升50%，再也不用纠结复杂流程！



在Git工作流中，主分支（`main`）、功能开发分支（`feature`）和标签（`tag`）是三个核心组件，它们的关系和协作流程构成了版本控制的基础框架。以下是三者的关系及标准工作流程的详细解析：

---

### 🔧 **一、核心关系与角色定位**

|**组件**|**核心作用**|**生命周期**|**关键特性**|
|-|-|-|-|
|**主分支（main）**|代表生产环境的稳定代码，仅包含可发布的版本。|永久存在  |禁止直接开发，仅接受合并请求。|
|**功能分支（feature）**|隔离开发新功能或修复，避免污染主分支代码。|临时存在（功能完成后删除）|从主分支创建，命名需明确（如`feat/user-login`）。|
|**标签（tag）**|标记主分支上的关键提交（如版本发布），提供不可变的版本快照。|永久存在|静态指针，支持语义化版本（如`v1.0.0`）。|


> **协作逻辑**：
功能分支是**开发沙盒**，主分支是**稳定基线**，标签是**版本锚点**。
开发流程：功能分支 → 合并到主分支 → 主分支打标签。

---

### 🔄 **二、标准工作流程（从开发到发布）**

#### **1. 功能开发阶段**

- **创建功能分支**：从主分支切出新分支进行开发。  

```Bash
git checkout main              # 切换到主分支
git pull origin main           # 同步最新代码
git checkout -b feat/payment   # 创建并切换功能分支
```
- **开发与提交**：在功能分支上编码并提交。  

```Bash
git add .                      # 暂存更改
git commit -m "新增支付接口"     # 提交到本地
git push origin feat/payment    # 推送到远程
```

#### **2. 合并到主分支**

- **代码审查与测试**：通过Pull Request（PR）或合并请求将功能分支合并到主分支。  
- **合并操作**：  

```Bash
git checkout main              # 切回主分支
git merge feat/payment         # 合并功能分支
git push origin main           # 推送更新
```

#### **3. 版本发布与打标签**

- **创建标签**：在主分支的合并提交上打标签，标记版本。  

```Bash
git tag -a v1.2.0 -m "发布支付功能"  # 创建附注标签（含版本描述）
git push origin v1.2.0             # 推送标签到远程
```
- **语义化版本规范**：  
    - `v主版本.次版本.修订号`（如`v1.2.0`）：  
        - **主版本**：不兼容的API变更（重大升级）。  
        - **次版本**：向下兼容的功能新增。  
        - **修订号**：向下兼容的问题修复。  

#### **4. 清理与维护**

- **删除功能分支**：合并后及时清理。  

```Bash
git branch -d feat/payment      # 删除本地分支
git push origin --delete feat/payment  # 删除远程分支
```
- **标签回溯**：通过标签快速检出历史版本。  

```Bash
git checkout v1.2.0             # 切换到标签对应代码
```

---

### 🛠️ **三、关键场景与最佳实践**

1. **紧急修复（Hotfix）**：  
    - 从主分支创建`hotfix`分支修复 → 合并到主分支 → 打新标签（如`v1.2.1`）。  
2. **版本回滚**：  
    - 使用`git revert`撤销错误提交，或直接基于标签重新发布旧版本。  
3. **自动化集成**：  
    - CI/CD工具（如GitLab CI）监听标签推送事件，自动触发构建和部署：  

```YAML
deploy_job:
  only: /^v\d+\.\d+\.\d+$/  # 仅当标签匹配语义化版本时触发
  script: ./deploy.sh
```

---

### 💎 **四、总结：三者的核心协作逻辑**

1. **功能分支**：开发隔离 → 保证主分支稳定性。  
2. **主分支**：整合已验证的功能 → 作为发布基准。  
3. **标签**：固化主分支状态 → 提供可追溯的版本快照。  

> **流程口诀**：
开发在分支（`feature`），稳定在主支（`main`），发布靠标签（`tag`）。  

通过此流程，团队可高效协作，同时确保生产代码的稳定性和可追溯性。

