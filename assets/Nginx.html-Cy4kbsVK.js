import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,f as i,o as e}from"./app-Ck5oWAu9.js";const l={};function p(c,n){return e(),a("div",null,[...n[0]||(n[0]=[i(`<h1 id="nginx安装配置全攻略" tabindex="-1"><a class="header-anchor" href="#nginx安装配置全攻略"><span>Nginx安装配置全攻略</span></a></h1><h3 id="install-nginx" tabindex="-1"><a class="header-anchor" href="#install-nginx"><span>Install Nginx</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>$ sudo apt-get install nginx</span></span>
<span class="line"><span></span></span>
<span class="line"><span>### 测试配置文件01</span></span>
<span class="line"><span>Test the config &amp; Restart nginx: </span></span>
<span class="line"><span>$ sudo service nginx configtest &amp;&amp; sudo service nginx restart</span></span>
<span class="line"><span></span></span>
<span class="line"><span>### 测试配置文件02</span></span>
<span class="line"><span>TIP: You can pinpoint problems in your nginx config using the following command</span></span>
<span class="line"><span>$ sudo nginx -t</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="basic-auth" tabindex="-1"><a class="header-anchor" href="#basic-auth"><span>Basic Auth</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>1、生成认证文件</span></span>
<span class="line"><span># printf &quot;test:$(openssl passwd -crypt 123456)\\n&quot; &gt;&gt; /etc/nginx/htpasswd </span></span>
<span class="line"><span># cat /etc/nginx/htpasswd </span></span>
<span class="line"><span>test:xyJkVhXGAZ8tM</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2、配置网站conf文件</span></span>
<span class="line"><span>server{</span></span>
<span class="line"><span>       listen 80;</span></span>
<span class="line"><span>       server_name  www.moerats.com moerats.com;</span></span>
<span class="line"><span>       index index.html index.php;</span></span>
<span class="line"><span>       root /home/wwwroot/www.moerats.com;       </span></span>
<span class="line"><span>       location /</span></span>
<span class="line"><span>       {</span></span>
<span class="line"><span>                auth_basic &quot;Please enter your username and password&quot;;</span></span>
<span class="line"><span>                auth_basic_user_file /etc/nginx/htpasswd; </span></span>
<span class="line"><span>                autoindex on; # 打开目录浏览功能</span></span>
<span class="line"><span>       }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3、重启Nginx</span></span>
<span class="line"><span>/etc/init.d/nginx restart</span></span>
<span class="line"><span>/usr/local/nginx/sbin/nginx -t测试配置是否有错误。 </span></span>
<span class="line"><span>/usr/local/nginx/sbin/nginx -s reload载入配置文件。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="http-proxy" tabindex="-1"><a class="header-anchor" href="#http-proxy"><span>Http Proxy</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>$ vi /etc/nginx/sites-enabled/local8080</span></span>
<span class="line"><span>$ /etc/init.d/nginx reload</span></span>
<span class="line"><span></span></span>
<span class="line"><span>upstream local8080 {</span></span>
<span class="line"><span>    server 127.0.0.1:8080 weight=1;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>server {</span></span>
<span class="line"><span>    #侦听的80端口</span></span>
<span class="line"><span>    listen       80;</span></span>
<span class="line"><span>    server_name  sso.lab.com;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    #匹配以jsp结尾的，tomcat的网页文件是以jsp结尾</span></span>
<span class="line"><span>    location / {</span></span>
<span class="line"><span>        index index.html;</span></span>
<span class="line"><span>        proxy_pass   http://local8080;    #在这里设置一个代理，和upstream的名字一样</span></span>
<span class="line"><span>        #以下是一些反向代理的配置可删除</span></span>
<span class="line"><span>        proxy_redirect             off;</span></span>
<span class="line"><span>        #后端的Web服务器可以通过X-Forwarded-For获取用户真实IP</span></span>
<span class="line"><span>        proxy_set_header           Host $host;</span></span>
<span class="line"><span>        proxy_set_header           X-Real-IP $remote_addr;</span></span>
<span class="line"><span>        proxy_set_header           X-Forwarded-For $proxy_add_x_forwarded_for;</span></span>
<span class="line"><span>        client_max_body_size       10m; #允许客户端请求的最大单文件字节数</span></span>
<span class="line"><span>        client_body_buffer_size    128k; #缓冲区代理缓冲用户端请求的最大字节数</span></span>
<span class="line"><span>        proxy_connect_timeout      300; #nginx跟后端服务器连接超时时间(代理连接超时)</span></span>
<span class="line"><span>        proxy_send_timeout         300; #后端服务器数据回传时间(代理发送超时)</span></span>
<span class="line"><span>        proxy_read_timeout         300; #连接成功后，后端服务器响应时间(代理接收超时)</span></span>
<span class="line"><span>        proxy_buffer_size          4k; #设置代理服务器（nginx）保存用户头信息的缓冲区大小</span></span>
<span class="line"><span>        proxy_buffers              4 32k; #proxy_buffers缓冲区，网页平均在32k以下的话，这样设置</span></span>
<span class="line"><span>        proxy_busy_buffers_size    64k; #高负荷下缓冲大小（proxy_buffers*2）</span></span>
<span class="line"><span>        proxy_temp_file_write_size 64k; #设定缓存文件夹大小，大于这个值，将从upstream服务器传</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    #设定查看Nginx状态的地址</span></span>
<span class="line"><span>    #location /nginxstatus{</span></span>
<span class="line"><span>    #     stub_status on;</span></span>
<span class="line"><span>    #     access_log on;</span></span>
<span class="line"><span>    #     auth_basic &quot;nginxstatus&quot;;</span></span>
<span class="line"><span>    #     auth_basic_user_file htpasswd;</span></span>
<span class="line"><span>    #}</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="云主机-nginx-tcp-端口转发" tabindex="-1"><a class="header-anchor" href="#云主机-nginx-tcp-端口转发"><span>云主机 nginx tcp 端口转发</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>- https://blog.csdn.net/qq_40863328/article/details/92802958</span></span>
<span class="line"><span>apt install nginx</span></span>
<span class="line"><span>vi /etc/nginx/nginx.conf</span></span>
<span class="line"><span>stream {</span></span>
<span class="line"><span>upstream tcp4444to22 {</span></span>
<span class="line"><span>            server 172.18.8.211:22;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>server {</span></span>
<span class="line"><span>            listen 4444;</span></span>
<span class="line"><span>            proxy_connect_timeout 8s;</span></span>
<span class="line"><span>            proxy_pass tcp4444to22;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="nginx-location-在配置中的优先级" tabindex="-1"><a class="header-anchor" href="#nginx-location-在配置中的优先级"><span>NGINX location 在配置中的优先级</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>NGINX location 在配置中的优先级 - 技术颜良 - 博客园 (cnblogs.com)</span></span>
<span class="line"><span>nginx location配置详细解释 - 星朝 - 博客园 (cnblogs.com)</span></span>
<span class="line"><span>location表达式类型</span></span>
<span class="line"><span>~ 表示执行一个正则匹配，区分大小写</span></span>
<span class="line"><span>~* 表示执行一个正则匹配，不区分大小写</span></span>
<span class="line"><span>^~ 表示普通字符匹配。使用前缀匹配。如果匹配成功，则不再匹配其他location。</span></span>
<span class="line"><span>= 进行普通字符精确匹配。也就是完全匹配。</span></span>
<span class="line"><span>@ &quot;@&quot; 定义一个命名的 location，使用在内部定向时，例如 error_page, try_files</span></span>
<span class="line"><span>location优先级说明</span></span>
<span class="line"><span>在nginx的location和配置中location的顺序没有太大关系。正location表达式的类型有关。相同类型的表达式，字符串长的会优先匹配。</span></span>
<span class="line"><span>以下是按优先级排列说明：</span></span>
<span class="line"><span>第一优先级：等号类型（=）的优先级最高。一旦匹配成功，则不再查找其他匹配项。</span></span>
<span class="line"><span>第二优先级：^~类型表达式。一旦匹配成功，则不再查找其他匹配项。</span></span>
<span class="line"><span>第三优先级：正则表达式类型（~ ~*）的优先级次之。如果有多个location的正则能匹配的话，则使用正则表达式最长的那个。</span></span>
<span class="line"><span>第四优先级：常规字符串匹配类型。按前缀匹配。</span></span>
<span class="line"><span>location优先级示例</span></span>
<span class="line"><span>配置项如下:</span></span>
<span class="line"><span>location = / {</span></span>
<span class="line"><span># 仅仅匹配请求 /</span></span>
<span class="line"><span>[ configuration A ]</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>location / {</span></span>
<span class="line"><span># 匹配所有以 / 开头的请求。但是如果有更长的同类型的表达式，则选择更长的表达式。如果有正则表达式可以匹配，则</span></span>
<span class="line"><span># 优先匹配正则表达式。</span></span>
<span class="line"><span>[ configuration B ]</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>location /documents/ {</span></span>
<span class="line"><span># 匹配所有以 /documents/ 开头的请求。但是如果有更长的同类型的表达式，则选择更长的表达式。</span></span>
<span class="line"><span>#如果有正则表达式可以匹配，则优先匹配正则表达式。</span></span>
<span class="line"><span>[ configuration C ]</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>location ^~ /images/ {</span></span>
<span class="line"><span># 匹配所有以 /images/ 开头的表达式，如果匹配成功，则停止匹配查找。所以，即便有符合的正则表达式location，也</span></span>
<span class="line"><span># 不会被使用</span></span>
<span class="line"><span>[ configuration D ]</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>location ~* \\.(gif|jpg|jpeg)$ {</span></span>
<span class="line"><span># 匹配所有以 gif jpg jpeg结尾的请求。但是 以 /images/开头的请求，将使用 Configuration D</span></span>
<span class="line"><span>[ configuration E ]</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>请求匹配示例</span></span>
<span class="line"><span>/ -&gt; configuration A</span></span>
<span class="line"><span>/index.html -&gt; configuration B</span></span>
<span class="line"><span>/documents/document.html -&gt; configuration C</span></span>
<span class="line"><span>/images/1.gif -&gt; configuration D</span></span>
<span class="line"><span>/documents/1.jpg -&gt; configuration E</span></span>
<span class="line"><span>注意，以上的匹配和在配置文件中定义的顺序无关。</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 来自 &lt;https://www.bo56.com/nginx-location%E5%9C%A8%E9%85%8D%E7%BD%AE%E4%B8%AD%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7/&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,11)])])}const t=s(l,[["render",p]]),o=JSON.parse('{"path":"/tld/prod/Nginx.html","title":"Nginx安装配置全攻略","lang":"zh-CN","frontmatter":{"date":"2023-09-01T00:00:00.000Z","title":"Nginx安装配置全攻略","author":["SecCMD"],"description":"本页面专注于Nginx服务器的安装与配置技巧，涵盖从基础安装到多种高级应用场景。介绍Nginx安装指令，以及如何测试配置文件确保其正确性。深入讲解Basic Auth认证设置、Http Proxy代理配置、云主机TCP端口转发等操作，还详细阐述NGINX location在配置中的优先级，为您提供全面且实用的Nginx使用指引。\\n","categories":"基础工具","tags":["Nginx","网络代理"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Nginx安装配置全攻略\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-09-01T00:00:00.000Z\\",\\"dateModified\\":\\"2025-09-12T16:33:57.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"SecCMD\\"}]}"],["meta",{"property":"og:url","content":"https://www.seccmd.net/tld/prod/Nginx.html"}],["meta",{"property":"og:site_name","content":"明剑实验室"}],["meta",{"property":"og:title","content":"Nginx安装配置全攻略"}],["meta",{"property":"og:description","content":"本页面专注于Nginx服务器的安装与配置技巧，涵盖从基础安装到多种高级应用场景。介绍Nginx安装指令，以及如何测试配置文件确保其正确性。深入讲解Basic Auth认证设置、Http Proxy代理配置、云主机TCP端口转发等操作，还详细阐述NGINX location在配置中的优先级，为您提供全面且实用的Nginx使用指引。\\n"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-12T16:33:57.000Z"}],["meta",{"property":"article:author","content":"SecCMD"}],["meta",{"property":"article:tag","content":"网络代理"}],["meta",{"property":"article:tag","content":"Nginx"}],["meta",{"property":"article:published_time","content":"2023-09-01T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-09-12T16:33:57.000Z"}]]},"git":{"createdTime":1737538884000,"updatedTime":1757694837000,"contributors":[{"name":"seccmd","username":"seccmd","email":"79789833+seccmd@users.noreply.github.com","commits":1,"url":"https://github.com/seccmd"},{"name":"fireadm","username":"fireadm","email":"iwanwu@hotmail.com","commits":3,"url":"https://github.com/fireadm"}]},"readingTime":{"minutes":4.2,"words":1259},"filePathRelative":"tld/prod/Nginx.md"}');export{t as comp,o as data};
