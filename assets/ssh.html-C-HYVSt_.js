import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,f as n,o as l}from"./app-Da1vT5-m.js";const t={};function h(e,s){return l(),a("div",null,[...s[0]||(s[0]=[n(`<h1 id="ssh-in-one" tabindex="-1"><a class="header-anchor" href="#ssh-in-one"><span>SSH in One</span></a></h1><h2 id="å¯ç”¨-å…³é—­-windows-ssh-æœåŠ¡å™¨" tabindex="-1"><a class="header-anchor" href="#å¯ç”¨-å…³é—­-windows-ssh-æœåŠ¡å™¨"><span>å¯ç”¨/å…³é—­ Windows SSH æœåŠ¡å™¨</span></a></h2><p>å¯ç”¨/å…³é—­ Windows SSH æœåŠ¡å™¨ã€å¼ºåˆ¶å¯†é’¥è®¤è¯å¹¶é™åˆ¶ç™»å½•è´¦å·çš„ PowerShell è„šæœ¬ï¼Œå·²é›†æˆå®‰å…¨é…ç½®ï¼š</p><div class="language-powershell line-numbers-mode" data-highlighter="shiki" data-ext="powershell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-powershell"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># SSH_Manager.ps1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åŠŸèƒ½ï¼šä¸€é”®å¯ç”¨/ç¦ç”¨ Windows OpenSSH æœåŠ¡å™¨ï¼Œé…ç½®å¯†é’¥è®¤è¯+æŒ‡å®šè´¦å·ç™»å½•</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># éœ€ä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">param</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    [</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">Parameter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">Mandatory</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">$true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    [</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">ValidateSet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Enable&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Disable&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    [</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">string</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$Action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    [</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">string</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$AllowedUser</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Admin&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # æ›¿æ¢ä¸ºä½ çš„æŒ‡å®šè´¦å·</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å®‰å…¨é…ç½®å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Configure-SSH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # å¤‡ä»½åŸå§‹é…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    $configPath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">$</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">env:ProgramData</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\\ssh\\sshd_config&quot;</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    Copy-Item</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $configPath</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">$</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">configPath</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.bak&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Force</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # ç¦ç”¨å¯†ç ç™»å½• &amp; å¯ç”¨å¯†é’¥è®¤è¯</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    (</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">Get-Content</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $configPath</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) | </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">ForEach-Object</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        $_ </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-replace</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;#?PasswordAuthentication\\s+.+&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;PasswordAuthentication no&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> \`</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">           -replace</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;#?PubkeyAuthentication\\s+.+&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;PubkeyAuthentication yes&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> \`</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">           -replace</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;#?PermitRootLogin\\s+.+&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;PermitRootLogin no&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> \`</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">           -replace</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;#?AllowUsers\\s+.+&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;AllowUsers </span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">$</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">AllowedUser</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    } | </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">Set-Content</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $configPath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Force</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ·»åŠ AllowUsersæŒ‡ä»¤ï¼ˆå¦‚ä¸å­˜åœ¨ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-not</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">Select-String</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Path </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$configPath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Pattern </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;AllowUsers </span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">$</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">AllowedUser</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        Add-Content</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $configPath</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\`n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">AllowUsers </span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">$</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">AllowedUser</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Force</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # ä¿®å¤å¯†é’¥æ–‡ä»¶æƒé™ï¼ˆå…³é”®å®‰å…¨è®¾ç½®ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    $authorizedKeys</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">$</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">env:ProgramData</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\\ssh\\administrators_authorized_keys&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">Test-Path</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $authorizedKeys</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        icacls </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$authorizedKeys</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> /</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">inheritance:r </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">grant </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;SYSTEM:(F)&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">$</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">env:USERNAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:(F)&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä¸»é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">switch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$Action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    &quot;Enable&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # å®‰è£…OpenSSHæœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-not</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">Get-WindowsCapability</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Online </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Name </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;OpenSSH.Server*&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">Where-Object</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> State </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-eq</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Installed&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">            Add-WindowsCapability</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Online </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Name OpenSSH.Server~~~~</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # å¯åŠ¨æœåŠ¡å¹¶è®¾è‡ªå¯</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        Start-Service</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sshd</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        Set-Service</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Name sshd </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">StartupType Automatic</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # åº”ç”¨å®‰å…¨é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        Configure</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">SSH</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # æ”¾è¡Œé˜²ç«å¢™</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        New-NetFirewallRule</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Name </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;OpenSSH-Server&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">DisplayName </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;OpenSSH Server (sshd)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> \`</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">            -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Enabled True </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Direction Inbound </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Protocol TCP </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Action Allow </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">LocalPort </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">22</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        Write-Host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;âœ… SSH å·²å¯ç”¨ - ä»…å…è®¸è´¦å· [</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">$</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">AllowedUser</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">] é€šè¿‡å¯†é’¥ç™»å½•&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ForegroundColor Green</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    &quot;Disable&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # åœæ­¢æœåŠ¡å¹¶ç¦ç”¨è‡ªå¯</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        Stop-Service</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sshd </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Force </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ErrorAction Silentl</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        Set-Service</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Name sshd </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">StartupType Disabled</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # ç§»é™¤é˜²ç«å¢™è§„åˆ™</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        Remove-NetFirewallRule</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">DisplayName </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;OpenSSH Server (sshd)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ErrorAction SilentlyContinue</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        Write-Host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;â›” SSH å·²å…³é—­&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ForegroundColor Red</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># éªŒè¯çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$status</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">Get-Service</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sshd).Status</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">Write-Host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;æœåŠ¡çŠ¶æ€: </span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">$</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> | é…ç½®è·¯å¾„: </span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">$</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">env:ProgramData</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\\ssh\\sshd_config&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ğŸ”’-å®‰å…¨è®¾è®¡è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ğŸ”’-å®‰å…¨è®¾è®¡è¯´æ˜"><span>ğŸ”’ å®‰å…¨è®¾è®¡è¯´æ˜</span></a></h3><ol><li><strong>å¼ºåˆ¶å¯†é’¥è®¤è¯</strong><ul><li>ç¦ç”¨å¯†ç ç™»å½•ï¼š<code>PasswordAuthentication no</code>[citation:10][citation:11]</li><li>å¯ç”¨å…¬é’¥è®¤è¯ï¼š<code>PubkeyAuthentication yes</code></li><li>ä¿®å¤å¯†é’¥æ–‡ä»¶æƒé™ï¼šé˜²æ­¢æƒé™é”™è¯¯å¯¼è‡´è®¤è¯å¤±æ•ˆ[citation:9]</li></ul></li><li><strong>è´¦å·ç™½åå•</strong><ul><li>ä»…å…è®¸æŒ‡å®šè´¦å·ï¼š<code>AllowUsers Admin</code>ï¼ˆæ›¿æ¢<code>Admin</code>ä¸ºä½ çš„è´¦å·ï¼‰[citation:9]</li><li>ç¦æ­¢rootç™»å½•ï¼š<code>PermitRootLogin no</code>[citation:11]</li></ul></li><li><strong>æœåŠ¡ç®¡ç†</strong><ul><li>è‡ªåŠ¨å®‰è£…OpenSSHï¼ˆå¦‚æœªå®‰è£…ï¼‰</li><li>é˜²ç«å¢™è§„åˆ™è‡ªåŠ¨é…ç½®ï¼šä»…å¼€æ”¾22ç«¯å£</li><li>æœåŠ¡è‡ªå¯ç®¡ç†ï¼šå¯ç”¨æ—¶è®¾è‡ªå¯ï¼Œç¦ç”¨æ—¶å½»åº•å…³é—­</li></ul></li></ol><h3 id="âš ï¸-ä½¿ç”¨å‰å‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#âš ï¸-ä½¿ç”¨å‰å‡†å¤‡"><span>âš ï¸ ä½¿ç”¨å‰å‡†å¤‡</span></a></h3><ol><li><strong>ç”ŸæˆSSHå¯†é’¥å¯¹</strong>ï¼ˆå®¢æˆ·ç«¯æ‰§è¡Œï¼‰ï¼š</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ssh-keygen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ed25519</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li><strong>éƒ¨ç½²å…¬é’¥åˆ°WindowsæœåŠ¡å™¨</strong>ï¼š <ul><li>å¤åˆ¶ <code>id_ed25519.pub</code> å†…å®¹</li><li>ä¿å­˜åˆ° <code>C:\\ProgramData\\ssh\\administrators_authorized_keys</code></li></ul></li></ol><h3 id="ğŸš€-æ‰§è¡Œæ–¹å¼" tabindex="-1"><a class="header-anchor" href="#ğŸš€-æ‰§è¡Œæ–¹å¼"><span>ğŸš€ æ‰§è¡Œæ–¹å¼</span></a></h3><div class="language-powershell line-numbers-mode" data-highlighter="shiki" data-ext="powershell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-powershell"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å¯ç”¨SSHï¼ˆæŒ‡å®šè´¦å·ä¸ºAdminï¼‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.\\SSH_Manager.ps1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Action Enable </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">AllowedUser Admin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å…³é—­SSH</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.\\SSH_Manager.ps1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Action Disable</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>å®‰å…¨æç¤ºï¼šé¦–æ¬¡å¯ç”¨åï¼Œ<strong>ç«‹å³æµ‹è¯•å¯†é’¥ç™»å½•</strong>ï¼š<br><code>ssh Admin@æœåŠ¡å™¨IP </code>è‹¥å¤±è´¥è¯·æ£€æŸ¥ <code>administrators_authorized_keys</code> æ–‡ä»¶æƒé™ï¼ˆå³é”®â†’å±æ€§â†’å®‰å…¨â†’ä»…ä¿ç•™SYSTEMå’Œå½“å‰ç”¨æˆ·å®Œå…¨æ§åˆ¶ï¼‰[citation:9]</p></blockquote><h3 id="ğŸ“Œ-å…³é”®é…ç½®é¡¹è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ğŸ“Œ-å…³é”®é…ç½®é¡¹è¯´æ˜"><span>ğŸ“Œ å…³é”®é…ç½®é¡¹è¯´æ˜</span></a></h3><table><thead><tr><th>é…ç½®æŒ‡ä»¤</th><th>è®¾å®šå€¼</th><th>å®‰å…¨ä½œç”¨</th></tr></thead><tbody><tr><td><code>PasswordAuthentication</code></td><td><code>no</code></td><td>å½»åº•ç¦ç”¨å¯†ç ç™»å½•[citation:11]</td></tr><tr><td><code>PubkeyAuthentication</code></td><td><code>yes</code></td><td>å¼ºåˆ¶å¯†é’¥è®¤è¯</td></tr><tr><td><code>AllowUsers</code></td><td>æŒ‡å®šç”¨æˆ·å</td><td>é™åˆ¶ç™»å½•è´¦å·ç™½åå•</td></tr><tr><td><code>administrators_authorized_keys</code>æƒé™</td><td>ä»…SYSTEM+ç”¨æˆ·</td><td>é˜²æ­¢æƒé™ç»§æ‰¿å¯¼è‡´è®¤è¯å¤±æ•ˆ</td></tr></tbody></table><blockquote><p>æ­¤è„šæœ¬å·²å®ç°ä¼ä¸šçº§å®‰å…¨åŸºçº¿é…ç½®ï¼Œæ— éœ€é¢å¤–æ“ä½œå³å¯æŠµå¾¡å¯†ç çˆ†ç ´æ”»å‡»ã€‚å»ºè®®å®šæœŸå®¡è®¡ <code>sshd_config</code> æ–‡ä»¶å®Œæ•´æ€§[citation:10]ã€‚</p></blockquote>`,16)])])}const d=i(t,[["render",h]]),r=JSON.parse('{"path":"/tld/dev/ssh.html","title":"SSH in One","lang":"zh-CN","frontmatter":{"description":"SSH in One å¯ç”¨/å…³é—­ Windows SSH æœåŠ¡å™¨ å¯ç”¨/å…³é—­ Windows SSH æœåŠ¡å™¨ã€å¼ºåˆ¶å¯†é’¥è®¤è¯å¹¶é™åˆ¶ç™»å½•è´¦å·çš„ PowerShell è„šæœ¬ï¼Œå·²é›†æˆå®‰å…¨é…ç½®ï¼š ğŸ”’ å®‰å…¨è®¾è®¡è¯´æ˜ å¼ºåˆ¶å¯†é’¥è®¤è¯ ç¦ç”¨å¯†ç ç™»å½•ï¼šPasswordAuthentication no[citation:10][citation:11] å¯ç”¨å…¬é’¥è®¤è¯ï¼šP...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"SSH in One\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-09-09T12:08:14.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"SecCMD\\",\\"url\\":\\"https://www.seccmd.net\\"}]}"],["meta",{"property":"og:url","content":"https://www.seccmd.net/tld/dev/ssh.html"}],["meta",{"property":"og:site_name","content":"æ˜å‰‘å®éªŒå®¤"}],["meta",{"property":"og:title","content":"SSH in One"}],["meta",{"property":"og:description","content":"SSH in One å¯ç”¨/å…³é—­ Windows SSH æœåŠ¡å™¨ å¯ç”¨/å…³é—­ Windows SSH æœåŠ¡å™¨ã€å¼ºåˆ¶å¯†é’¥è®¤è¯å¹¶é™åˆ¶ç™»å½•è´¦å·çš„ PowerShell è„šæœ¬ï¼Œå·²é›†æˆå®‰å…¨é…ç½®ï¼š ğŸ”’ å®‰å…¨è®¾è®¡è¯´æ˜ å¼ºåˆ¶å¯†é’¥è®¤è¯ ç¦ç”¨å¯†ç ç™»å½•ï¼šPasswordAuthentication no[citation:10][citation:11] å¯ç”¨å…¬é’¥è®¤è¯ï¼šP..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-09T12:08:14.000Z"}],["meta",{"property":"article:modified_time","content":"2025-09-09T12:08:14.000Z"}]]},"git":{"createdTime":1757419694000,"updatedTime":1757419694000,"contributors":[{"name":"fireadm","username":"fireadm","email":"iwanwu@hotmail.com","commits":1,"url":"https://github.com/fireadm"}]},"readingTime":{"minutes":2.61,"words":782},"filePathRelative":"tld/dev/ssh.md","autoDesc":true}');export{d as comp,r as data};
